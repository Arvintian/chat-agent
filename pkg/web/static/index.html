<!DOCTYPE html>
<html>

<head>
    <title>Chat-Agent</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="login-panel" id="login-panel">
        <h2 id="login-header">ü§ñ Chat-Agent</h2>
        <div class="login-controls">
            <select id="chat-select">
                <option value="">-- Select a chat --</option>
            </select>
            <button id="start-btn" onclick="startChat()">Start Chat</button>
        </div>
    </div>

    <div class="page-wrapper" id="chat-panel" style="display: none; flex-direction: column;">
        <div class="header">
            <div class="header-left">
                <span id="agent-header">ü§ñ Chat-Agent</span>
            </div>
            <div class="header-right">
                <button id="clear-btn" onclick="showClearModal()" title="Clear Conversation">üóëÔ∏è Clear</button>
            </div>
        </div>

        <!-- Clear Session Modal -->
        <div id="clear-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>üóëÔ∏è Clear Conversation</h3>
                    <span class="modal-close" onclick="hideClearModal()">√ó</span>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to clear the conversation for:</p>
                    <p id="clear-chat-name" style="font-weight: bold; margin: 10px 0; color: #667eea;"></p>
                    <p style="color: #666; font-size: 13px;">‚ö†Ô∏è This action cannot be undone. All messages will be
                        permanently deleted.</p>
                    <div class="clear-option">
                        <label for="clear-all-records">
                            <input type="checkbox" id="clear-all-records">
                            <span>Also delete all local storage records for this chat</span>
                        </label>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn-cancel" onclick="hideClearModal()">Cancel</button>
                    <button class="btn-confirm" onclick="confirmClear()">Clear</button>
                </div>
            </div>
        </div>

        <!-- Approval Modal -->
        <div id="approval-modal" class="modal" style="display: none;" onclick="return false;">
            <div class="modal-content approval-modal-content" onclick="event.stopPropagation();">
                <div class="modal-header approval-modal-header">
                    <h3>‚ö†Ô∏è Tool Approval Required</h3>
                </div>
                <div class="modal-body approval-modal-body">
                    <p class="approval-description">The following tool(s) require your approval to execute:</p>
                    <p class="approval-count">Total: <span id="approval-count">0</span> tool(s)</p>
                    <div id="approval-targets" class="approval-targets-container">
                        <!-- Targets will be dynamically inserted here -->
                    </div>
                </div>
                <div class="modal-footer approval-modal-footer">
                    <div class="bulk-actions">
                        <button class="btn-approve-all" onclick="approveAllAndSubmit()">‚úÖ Approve All</button>
                        <button class="btn-deny-all" onclick="denyAllAndSubmit()">‚ùå Deny All</button>
                    </div>
                    <button class="btn-confirm" id="btn-submit-approval" onclick="submitApprovals()" disabled>Submit Decision</button>
                </div>
            </div>
        </div>

        <div class="toast-container" id="toast-container">
        </div>
        <div id="messages">
        </div>
        <div id="input-area">
            <div class="input-wrapper">
                <textarea id="message-input" placeholder="Type your message..." onkeydown="handleKeyDown(event)"
                    oninput="autoResize(this)"></textarea>
                <button id="send-btn" onclick="sendMessage()" title="Send message">‚û§</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>

</html>